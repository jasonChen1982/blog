---
title: bezier-easing实现平滑的插值
date: 2014-11-25
status: finished
author: jason82
---

我们都知道，`CSS3`里面的插值函数用的是` beizer`曲线。如同前面所说的，贝塞尔曲线是一个可递归的、特殊的样条曲线。但是这里我将主要介绍其众多特性中的一个特性，利用贝塞尔曲线来做插值操作。了解`CSS3`的都很清楚，我们在`transition`和`animation`中都有用到贝塞尔的插值功能，比如我想让一个物体先加速再减速的往右运动，那么这个过程应该如何实现呢？

在谈` beizer`曲线如何实现动画的加减速变换之前我们先来探讨一下动画是什么，程序上一般有几种方式来处理动画过程。

首先动画最简单的定义就是物体的一连贯的动作我们就可以称作为动画，例如汽车的移动，风扇的转动，窗帘的摇摆。在现实世界中这些动作从广义上来讲它们是时间上连续的也就是说它是在时间轴上的一个函数，但是从物理的角度上来看待这些动画的话它们可以描述成基于速度的连续累积。因此在程序实现的动画中我们也经常使用这两种方式来实现动画：`基于时间` 和 `基于物理量`(速度、加速度、摩擦等)。

基于物理量很好理解，物理里面的一大领域就是来研究物体运动的，比如一个物体的自由落体我们知道就有两个物理量`当前速度`和`加速度`。如果是在程序里面模拟物体的自由落体那就是两个变量，比如下面代码：

```javascript
var ball = { y: 0 };
var speed = 1;
var acceleration = 0.1;

setInterval(function() {
  speed += acceleration;
  ball.y += speed;
}, 1000/30);
```

这样就实现了一个最简单的基于物理量的动画。

除了基于物理量的方式来处理动画，还有基于时间的方式，这也是我们这次所要讲的方式。之前讲了从广义上来讲基于时间的运动其实可以看成是物体位置属性在时间轴上的一个函数。比如我们期望物体在1s内在X轴从0移动到20的位置，这个过程可以用函数`Xt = Fn(t，duration, start, end)`(t的区间为[0, duration])来表示。如果是匀速的话那么`Fn`的实现方式就是:

```javascript
function Fn(t, duration, start, end) {
  var progress = t / duration;
  return start + (end - start) * progress;
}
```

如果是加速的话就可以是:

```javascript
function Fn(t, duration, start, end) {
  var progress = t / duration;
  return start + (end - start) * progress * progress;
}
```

其实这里的原理很简单，`progress`是一个[0, 1]之间的数值，那么我们对他进行一个平方就会得到一个开始平缓然后逐渐陡峭的曲线。如果仔细看你会发现这就是一个插值的过程，在`start`和`end`之间进行插值，插值的比例根据不同的函数来进行曲线调整。

用来调整插值比例的曲线有很多种，例如刚才说的这种最简单的`y = x^2`在x为[0, 1]之间的曲线，还有一些其他的数学曲线。除此之外还有运用最为广泛的`cubic-bezier`曲线。同上述的原理我们需要找到一个