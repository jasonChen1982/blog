---
title: npm模块安装
date: 2015-01-11
---

npm的模块可以安装在全局也可以安装在本地
默认安装在本地


查看文件夹内容
windows下：
	dir /folders
UNIX系列下:
	ls /folders

npm i xxx^1.*.* [-S|--save]本地依赖 [-D|--save-dev]开发依赖 [-E|--save-exact]精确版本依赖 [-O|--save-optional]可选依赖 [npm i xxx -ES]安装制定版本到本地目录

卸载模块
npm uninstall [-g] [<pkg>...] []
aliases: remove, rm, r, un, unlink

更新模块
npm update [-g] [<pkg>...]

检查模块是否过时
npm outdated

查看模块
npm ls [-g]
aliases: list, la, ll

查看包的安装路径
npm root [-g]

管理npm的配置路径
npm config

npm config set <key> <value> [-g|--global]
npm config get <key>
npm config delete <key>
npm config list
npm config edit
npm get <key>
npm set <key> <value> [-g|--global]

设置网络代理
npm config set proxy=http://dev-proxy.oa.com:8080

设置镜像
npm config set registry="http://r.cnpmjs.org"
或者用cnpm
npm install -g cnpm --registry=https://registry.npm.taobao.org

管理模块的缓存
npm cache

查看模块版本
npm version

npm version [<newversion> | major | minor | patch | premajor | preminor | prepatch | prerelease | from-git]

'npm [-v | --version]' to print npm version
'npm view <pkg> version' to view a package's published version
'npm ls' to inspect current package/dependency versions

查看模块的注册信息
npm view

npm view [<@scope>/]<name>[@<version>] [<field>[.<subfield>]...]

aliases: info, show, v

查看模块的依赖关系
npm view gulp dependencies

查看模块的源文件地址
npm view gulp repository.url

查看模块的贡献者，包含邮箱地址
npm view npm contributors

用户登录
npm adduser

npm adduser [--registry=url] [--scope=@orgname] [--always-auth]

在发布的包上设置访问级别
npm access

发布模块
npm publish


npm package.json的语法
英文原版：https://docs.npmjs.com/files/package.json

这块内容好多，国内有好心人整理：《npm的package.json中文文档》，从这份文档拷贝出一些比较常见的，如下：

默认值

npm会根据包内容设置一些默认值。

"scripts": {"start": "node server.js"}

如果包的根目录有server.js文件，npm会默认将start命令设置为node server.js。

"scripts":{"preinstall": "node-waf clean || true; node-waf configure build"}

如果包的根目录有wscript文件，npm会默认将preinstall命令用node-waf进行编译。

"scripts":{"preinstall": "node-gyp rebuild"}

如果包的根目录有binding.gyp文件，npm会默认将preinstall命令用node-gyp进行编译。

"contributors": [...]

如果包的根目录有AUTHORS文件，npm会默认逐行按Name <email> (url)格式处理，邮箱和url是可选的。#号和空格开头的行会被忽略。



npm package.json的语法
英文原版：https://docs.npmjs.com/files/package.json

这块内容好多，国内有好心人整理：《npm的package.json中文文档》，从这份文档拷贝出一些比较常见的，如下：

默认值

npm会根据包内容设置一些默认值。

"scripts": {"start": "node server.js"}

如果包的根目录有server.js文件，npm会默认将start命令设置为node server.js。

"scripts":{"preinstall": "node-waf clean || true; node-waf configure build"}

如果包的根目录有wscript文件，npm会默认将preinstall命令用node-waf进行编译。

"scripts":{"preinstall": "node-gyp rebuild"}

如果包的根目录有binding.gyp文件，npm会默认将preinstall命令用node-gyp进行编译。

"contributors": [...]

如果包的根目录有AUTHORS文件，npm会默认逐行按Name <email> (url)格式处理，邮箱和url是可选的。#号和空格开头的行会被忽略。

#name

在package.json中最重要的就是name和version字段。他们都是必须的，如果没有就无法install。name和version一起组成的标识在假设中是唯一的。改变包应该同时改变version。

name是这个东西的名字。注意：

不要把node或者js放在名字中。因为你写了package.json它就被假定成为了js，不过你可以用"engine"字段指定一个引擎（见后文）。
这个名字会作为在URL的一部分、命令行的参数或者文件夹的名字。任何non-url-safe的字符都是不能用的。
这个名字可能会作为参数被传入require()，所以它应该比较短，但也要意义清晰。
在你爱上你的名字之前，你可能要去npm registry查看一下这个名字是否已经被使用了。http://registry.npmjs.org/
version

version必须能被node-semver解析，它被包在npm的依赖中。（要自己用可以执行npm install semver）

可用的“数字”或者“范围”见semver(7).

description

放简介，字符串，方便在npm search中搜索

keywords

关键字，数组、字符串，方便在npm search中搜索

bugs

你项目的提交问题的url和（或）邮件地址

{
 "url" : "http://github.com/owner/project/issues", 
"email" : "project@hostname.com"
}
license

你应该要指定一个许可证，让人知道使用的权利和限制的。

最简单的方法是，假如你用一个像BSD或者MIT这样通用的许可证，就只需要指定一个许可证的名字，像这样：

{ "license" : "BSD" }
如果你又更复杂的许可条件，或者想要提供给更多地细节，可以这样:

"licenses" : [
  { "type" : "MyLicense"
  , "url" : "http://github.com/owner/project/path/to/license"
  }
]
repository

指定你的代码存放的地方。这个对希望贡献的人有帮助。如果git仓库在github上，那么npm docs命令能找到你。

这样做：

复制代码
"repository" :
  { "type" : "git"
  , "url" : "http://github.com/isaacs/npm.git"
  }

"repository" :
  { "type" : "svn"
  , "url" : "http://v8.googlecode.com/svn/trunk/"
  }
复制代码
URL应该是公开的（即便是只读的）能直接被未经过修改的版本控制程序处理的url。不应该是一个html的项目页面。因为它是给计算机看的。

scripts

“scripts”是一个由脚本命令组成的hash对象，他们在包不同的生命周期中被执行。key是生命周期事件，value是要运行的命令。

参考上面的npm start、npm test命令

更多详细请看 npm-scripts(7)

config

"config" hash可以用来配置用于包脚本中的跨版本参数。在实例中，如果一个包有下面的配置：

{
 "name" : "foo",
 "config" : { "port" : "8080" } 
}
然后有一个“start”命令引用了npm_package_config_port环境变量，用户可以通过npm config set foo:port 8001来重写他。

参见 npm-config(7) 和 npm-scripts(7)。

dependencies

依赖是给一组包名指定版本范围的一个hash。这个版本范围是一个由一个或多个空格分隔的字符串。依赖还可以用tarball或者git URL。

请不要将测试或过渡性的依赖放在dependencieshash中。见下文的devDependencies

详见semver(7).

version 必须完全和version一致
>version 必须比version大
>=version 同上
<version 同上
<=version 同上
~version 大约一样，见semver(7)
1.2.x 1.2.0, 1.2.1, 等，但不包括1.3.0
http://... 见下文'依赖URL'
* 所有
"" 空，同*
version1 - version2 同 >=version1 <=version2.
range1 || range2 二选一。
git... 见下文'依赖Git URL'
user/repo 见下文'GitHub URLs'
比如下面都是合法的：

复制代码
{ "dependencies" :
  { "foo" : "1.0.0 - 2.9999.9999"
  , "bar" : ">=1.0.2 <2.1.2"
  , "baz" : ">1.0.2 <=2.3.4"
  , "boo" : "2.0.1"
  , "qux" : "<1.0.0 || >=2.3.1 <2.4.5 || >=2.5.2 <3.0.0"
  , "asd" : "http://asdf.com/asdf.tar.gz"
  , "til" : "~1.2"
  , "elf" : "~1.2.3"
  , "two" : "2.x"
  , "thr" : "3.3.x"
  }
}
复制代码
devDependencies

如果有人要使用你的模块，那么他们可能不需要你开发使用的外部测试或者文档框架。

在这种情况下，最好将这些附属的项目列在devDependencies中。

这些东西会在执行npm link或者npm install的时候初始化，并可以像其他npm配置参数一样管理。详见npm-config(7)。

对于非特定平台的构建步骤，比如需要编译CoffeeScript，可以用prepublish脚本去实现，并把它依赖的包放在devDependency中。（译者注：prepublish定义了在执行npm publish的时候先行执行的脚本）

比如：

复制代码
{ "name": "ethopia-waza",
  "description": "a delightfully fruity coffee varietal",
  "version": "1.2.3",
  "devDependencies": {
    "coffee-script": "~1.6.3"
  },
  "scripts": {
    "prepublish": "coffee -o lib/ -c src/waza.coffee"
  },
  "main": "lib/waza.js"
}
复制代码
prepublish脚本会在publishing前运行，这样用户就不用自己去require来编译就能使用。并且在开发模式中（比如本地运行npm install）会运行这个脚本以便更好地测试。

## Script install and uninstall

some about .npmrc and npm config
